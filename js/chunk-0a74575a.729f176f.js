(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a74575a"],{"443a":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Row",[n("Col",{attrs:{span:"14"}},[n("Button",{attrs:{type:"info"},on:{click:function(e){t.openAddModal(null)}}},[n("Icon",{attrs:{type:"md-add"}}),t._v(" 添加报名")],1),n("Button",{attrs:{disabled:t.setting.loading,type:"success"},on:{click:t.refresh}},[n("Icon",{attrs:{type:"md-refresh"}}),t._v(" 刷新数据")],1),n("Button",{attrs:{type:"primary"},on:{click:function(e){t.exportData(1)}}},[n("Icon",{attrs:{type:"ios-download-outline"}}),t._v(" 导出表格")],1)],1),n("Col",{attrs:{span:"10"}},[n("Select",{attrs:{filterable:""},model:{value:t.targetId,callback:function(e){t.targetId=e},expression:"targetId"}},t._l(t.activities,function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.title))])}),1)],1)],1),n("Row",{staticStyle:{"margin-top":"20px"}},[n("Col",{staticStyle:{"font-size":"16px",color:"#6b6868",padding:"5px 0"},attrs:{span:"14"}},[n("span",{staticStyle:{margin:"0 20px"}},[n("Icon",{attrs:{type:"md-flame",size:"20",color:"#ea6f5a"}}),t._v(" 报名人数："+t._s(t.targetData.length))],1),n("span",[n("Icon",{attrs:{type:"md-checkbox-outline",size:"20",color:"#8a21d8"}}),t._v(" 已签到："+t._s(t.checkedNum))],1)]),n("Col",{attrs:{span:"10"}},[n("Input",{staticClass:"margin-bottom-10",attrs:{placeholder:"输入名字查找参赛者"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("Button",{attrs:{slot:"append",icon:"ios-search"},on:{click:t.doSearch},slot:"append"})],1)],1),n("Col",{attrs:{span:"24"}},[n("Table",{ref:"table",staticClass:"margin-bottom-10",attrs:{columns:t.columns,loading:t.setting.loading,border:t.setting.showBorder,data:t.targetData}})],1)],1)],1)},r=[],a=n("f499"),s=n.n(a),o=(n("7f7f"),n("ac6a"),n("96cf"),n("3b8d")),c=(n("5a0c"),n("d689")),u=3,h={data:function(){return{aparId:"",setting:{loading:!0,showBorder:!0},search:{type:"name",value:""},dataFilter:{page:1,pageSize:15},activities:[],targetId:"",targetData:[],targetRules:[],columns:[],checkedNum:0}},components:{},created:function(){this.aparId=this.$store.state.user.aparId,this.getData()},methods:{pageChange:function(t){this.dataFilter.page=t,this.getData()},pageSizeChange:function(t){this.dataFilter.pageSize=t,this.getData()},refresh:function(){this.getData(),this.getFormRules(),this.getSignupData()},doSearch:function(){alert("not ready, please wait")},getData:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,t.prev=1,t.next=4,Object(c["b"])("/app/activity/list/status",{aparId:this.aparId,status:u});case 4:e=t.sent,this.activities=e.data,null!=this.activities&&(this.targetId=this.activities[0].id),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),this.$throw(t.t0);case 12:this.setting.loading=!1;case 13:case"end":return t.stop()}},t,this,[[1,9]])}));function e(){return t.apply(this,arguments)}return e}(),getSignupData:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,n,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.checkedNum=0,this.setting.loading=!0,t.prev=2,t.next=5,Object(c["b"])("/app/activity/signup/get/list/{actiId}",null,{actiId:this.targetId});case 5:e=t.sent,n=e.data,this.targetData=[],n.forEach(function(t){t=JSON.parse(t),t.checkin&&i.checkedNum++,i.targetData.push(t)}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),this.$throw(t.t0);case 14:this.setting.loading=!1;case 15:case"end":return t.stop()}},t,this,[[2,11]])}));function e(){return t.apply(this,arguments)}return e}(),getFormRules:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,n,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,t.prev=1,t.next=4,Object(c["b"])("/app/activity/form/get/{id}",null,{id:this.targetId});case 4:e=t.sent,this.targetRules=JSON.parse(e.data.rules),this.columns=[],n={},this.targetRules.forEach(function(t){if("hidden"==t.type)n={title:"签到",key:t.field,sortable:!0,render:function(t,e){return 0==e.row.checkin?t("Button",{props:{type:"primary",size:"small"},style:{margin:"5px"},on:{click:function(){i.doCheckin(e.row)}}},"签到"):t("Button",{props:{type:"warning",size:"small"},style:{margin:"5px"},on:{click:function(){i.doCheckout(e.row)}}},"取消")}};else{var e={title:t.title,key:t.field,sortable:!0};i.columns.push(e)}}),this.columns.push(n),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$throw(t.t0);case 15:this.setting.loading=!1;case 16:case"end":return t.stop()}},t,this,[[1,12]])}));function e(){return t.apply(this,arguments)}return e}(),doCheckin:function(t){var e=this;this.$Modal.confirm({title:t.name+"同学",content:'<br><p>点击"确定"完成签到</p>',onOk:function(){e.AsyncCheckin(t,!0)}})},doCheckout:function(t){var e=this;this.$Modal.confirm({title:t.name+"同学",content:"<br><p>确定取消该同学签到吗？</p>",onOk:function(){e.AsyncCheckin(t,!1)}})},AsyncCheckin:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e,n){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,e.checkin=n,i={actiId:e.actiId,signupData:s()(e)},console.info(i),t.prev=4,t.next=7,Object(c["b"])("/app/activity/signup/checkin/",i);case 7:t.sent,this.getSignupData(),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$throw(t.t0);case 14:this.setting.loading=!1;case 15:case"end":return t.stop()}},t,this,[[4,11]])}));function e(e,n){return t.apply(this,arguments)}return e}(),exportData:function(t){var e=this,n="活动《";this.activities.forEach(function(t){t.id!=e.targetId||(n+=t.title)}),1===t&&this.$refs.table.exportCsv({filename:n+"》报名数据-"+(new Date).getTime(),columns:this.columns.filter(function(t,n){return n>1&&n<e.columns.length-1}),data:this.data})}},watch:{targetId:function(t,e){this.getFormRules(),this.getSignupData()}}},l=h,d=n("2877"),f=Object(d["a"])(l,i,r,!1,null,null,null);f.options.__file="index.vue";e["default"]=f.exports},"5a0c":function(t,e,n){!function(e,n){t.exports=n()}(0,function(){"use strict";var t="millisecond",e="second",n="minute",i="hour",r="day",a="week",s="month",o="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})(.*?(\d{1,2}):(\d{1,2}):(\d{1,2}))?.?(\d{1,3})?$/,u=/\[.*?\]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},l=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},d={padStart:l,padZoneStr:function(t){var e=Math.abs(t),n=Math.floor(e/60),i=e%60;return(t<=0?"+":"-")+l(n,2,"0")+":"+l(i,2,"0")},monthDiff:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(n,"months"),r=e-i<0,a=t.clone().add(n+(r?-1:1),"months");return Number(-(n+(e-i)/(r?i-a:a-i))||0)},absFloor:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},prettyUnit:function(c){return{M:s,y:o,w:a,d:r,h:i,m:n,s:e,ms:t}[c]||String(c||"").toLowerCase().replace(/s$/,"")},isUndefined:function(t){return void 0===t}},f="en",p={};p[f]=h;var g=function(t){return t instanceof D},m=function(t,e,n){var i;if(!t)return null;if("string"==typeof t)p[t]&&(i=t),e&&(p[t]=e,i=t);else{var r=t.name;p[r]=t,i=r}return n||(f=i),i},$=function(t,e){if(g(t))return t.clone();var n=e?"string"==typeof e?{format:e}:e:{};return n.date=t,new D(n)},v=function(t,e){return $(t,{locale:e.$L})},y=d;y.parseLocale=m,y.isDayjs=g,y.wrapper=v;var D=function(){function h(t){this.parse(t)}var l=h.prototype;return l.parse=function(t){var e,n;this.$d=null===(e=t.date)?new Date(NaN):y.isUndefined(e)?new Date:e instanceof Date?e:"string"==typeof e&&/.*[^Z]$/i.test(e)&&(n=e.match(c))?new Date(n[1],n[2]-1,n[3]||1,n[5]||0,n[6]||0,n[7]||0,n[8]||0):new Date(e),this.init(t)},l.init=function(t){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds(),this.$L=this.$L||m(t.locale,null,!0)||f},l.$utils=function(){return y},l.isValid=function(){return!("Invalid Date"===this.$d.toString())},l.isSame=function(t,e){var n=$(t);return this.startOf(e)<=n&&n<=this.endOf(e)},l.isAfter=function(t,e){return $(t)<this.startOf(e)},l.isBefore=function(t,e){return this.endOf(e)<$(t)},l.year=function(){return this.$y},l.month=function(){return this.$M},l.day=function(){return this.$W},l.date=function(){return this.$D},l.hour=function(){return this.$H},l.minute=function(){return this.$m},l.second=function(){return this.$s},l.millisecond=function(){return this.$ms},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(t,c){var u=this,h=!!y.isUndefined(c)||c,l=function(t,e){var n=v(new Date(u.$y,e,t),u);return h?n:n.endOf(r)},d=function(t,e){return v(u.toDate()[t].apply(u.toDate(),(h?[0,0,0,0]:[23,59,59,999]).slice(e)),u)};switch(y.prettyUnit(t)){case o:return h?l(1,0):l(31,11);case s:return h?l(1,this.$M):l(0,this.$M+1);case a:return l(h?this.$D-this.$W:this.$D+(6-this.$W),this.$M);case r:case"date":return d("setHours",0);case i:return d("setMinutes",1);case n:return d("setSeconds",2);case e:return d("setMilliseconds",3);default:return this.clone()}},l.endOf=function(t){return this.startOf(t,!1)},l.$set=function(a,c){var u,h=y.prettyUnit(a),l=(u={},u[r]="setDate",u.date="setDate",u[s]="setMonth",u[o]="setFullYear",u[i]="setHours",u[n]="setMinutes",u[e]="setSeconds",u[t]="setMilliseconds",u)[h],d=h===r?this.$D+(c-this.$W):c;return this.$d[l]&&this.$d[l](d),this.init(),this},l.set=function(t,e){return this.clone().$set(t,e)},l.add=function(t,c){var u,h=this;t=Number(t);var l=y.prettyUnit(c),d=function(e,n){var i=h.set("date",1).set(e,n+t);return i.set("date",Math.min(h.$D,i.daysInMonth()))},f=function(e){var n=new Date(h.$d);return n.setDate(n.getDate()+e*t),v(n,h)};if(l===s)return d(s,this.$M);if(l===o)return d(o,this.$y);if(l===r)return f(1);if(l===a)return f(7);var p=(u={},u[n]=6e4,u[i]=36e5,u[e]=1e3,u)[l]||1,g=this.valueOf()+t*p;return v(g,this)},l.subtract=function(t,e){return this.add(-1*t,e)},l.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=y.padZoneStr(this.$d.getTimezoneOffset()),r=this.$locale(),a=r.weekdays,s=r.months,o=function(t,e,n,i){return t&&t[e]||n[e].substr(0,i)},c=function(t){return 0===e.$H?12:y.padStart(e.$H<13?e.$H:e.$H-12,"hh"===t?2:1,"0")};return n.replace(u,function(t){return t.indexOf("[")>-1?t.replace(/\[|\]/g,""):{YY:String(e.$y).slice(-2),YYYY:String(e.$y),M:String(e.$M+1),MM:y.padStart(e.$M+1,2,"0"),MMM:o(r.monthsShort,e.$M,s,3),MMMM:s[e.$M],D:String(e.$D),DD:y.padStart(e.$D,2,"0"),d:String(e.$W),dd:o(r.weekdaysMin,e.$W,a,2),ddd:o(r.weekdaysShort,e.$W,a,3),dddd:a[e.$W],H:String(e.$H),HH:y.padStart(e.$H,2,"0"),h:c(t),hh:c(t),a:e.$H<12?"am":"pm",A:e.$H<12?"AM":"PM",m:String(e.$m),mm:y.padStart(e.$m,2,"0"),s:String(e.$s),ss:y.padStart(e.$s,2,"0"),SSS:y.padStart(e.$ms,3,"0"),Z:i}[t]||i.replace(":","")})},l.diff=function(t,c,u){var h,l=y.prettyUnit(c),d=$(t),f=this-d,p=y.monthDiff(this,d);return p=(h={},h[o]=p/12,h[s]=p,h.quarter=p/3,h[a]=f/6048e5,h[r]=f/864e5,h[i]=f/36e5,h[n]=f/6e4,h[e]=f/1e3,h)[l]||f,u?p:y.absFloor(p)},l.daysInMonth=function(){return this.endOf(s).$D},l.$locale=function(){return p[this.$L]},l.locale=function(t,e){var n=this.clone();return n.$L=m(t,e,!0),n},l.clone=function(){return v(this.toDate(),this)},l.toDate=function(){return new Date(this.$d)},l.toArray=function(){return[this.$y,this.$M,this.$D,this.$H,this.$m,this.$s,this.$ms]},l.toJSON=function(){return this.toISOString()},l.toISOString=function(){return this.$d.toISOString()},l.toObject=function(){return{years:this.$y,months:this.$M,date:this.$D,hours:this.$H,minutes:this.$m,seconds:this.$s,milliseconds:this.$ms}},l.toString=function(){return this.$d.toUTCString()},h}();return $.prototype=D.prototype,$.extend=function(t,e){return t(e,D,$),$},$.locale=m,$.isDayjs=g,$.unix=function(t){return $(1e3*t)},$.en=p[f],$})}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2226cb"],{cf0b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("p",{staticClass:"card-title",attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"home"}}),a("span",[t._v("活动管理")])],1),a("div",[[a("Row",[a("Col",{attrs:{span:"15"}},[a("Button",{attrs:{type:"info"},on:{click:function(e){t.openAddModal(null)}}},[a("Icon",{attrs:{type:"md-add"}}),t._v(" 创建活动")],1),a("Button",{attrs:{disabled:t.setting.loading,type:"success"},on:{click:t.getData}},[a("Icon",{attrs:{type:"md-refresh"}}),t._v(" 刷新数据")],1),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.exportData(1)}}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v(" 导出表格")],1)],1),a("Col",{attrs:{span:"9"}},[a("Input",{staticClass:"margin-bottom-10",attrs:{placeholder:"请输入您想要搜索的内容..."},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("Button",{attrs:{slot:"append",icon:"ios-search"},slot:"append"})],1)],1)],1),a("Table",{ref:"table",staticClass:"margin-bottom-10",attrs:{columns:t.columns,loading:t.setting.loading,border:t.setting.showBorder,data:t.data.records}}),a("Page",{staticClass:"tr",attrs:{total:t.data.total,current:t.data.current,"page-size":t.data.size,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"update:current":function(e){t.$set(t.data,"current",e)},"on-page-size-change":t.pageSizeChange}})]],2)]),t.addActivityModal?a("AddActivity",{on:{cancel:t.onModalCancel}}):t._e(),t.updateActivityModal?a("UpdateActivity",{attrs:{roles:t.roles,uid:t.updateId},on:{cancel:t.onModalCancel}}):t._e(),t.detailActivityModel?a("DetailActivity",{attrs:{editBaseForm:t.editBaseForm,data:t.detailVO},on:{cancel:t.onModalCancel,reEditBaseForm:t.reEditBaseForm}}):t._e(),a("Modal",{attrs:{scrollable:"",width:900,"mask-closable":!1},model:{value:t.editBaseFormModel,callback:function(e){t.editBaseFormModel=e},expression:"editBaseFormModel"}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("Button",{attrs:{size:"small"},on:{click:function(e){t.editBaseFormModel=!1}}},[t._v("返回")]),a("Button",{attrs:{size:"small"},on:{click:t.refreshBaseForm}},[t._v("刷新")])],1),a("BaseForm",{ref:"baseForm",attrs:{actiId:t.actiIdToEdit}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"info"},on:{click:function(e){t.editBaseFormModel=!1}}},[t._v("关闭")])],1)],1)],1)},n=[],s=(a("96cf"),a("3b8d")),o=a("5a0c"),r=a.n(o),c=a("d689"),l=a("64f9"),d=a("05bf"),u=a("b6db"),p=a("8b62"),h=1,m=2,g=3,f=4,y=5,v=0,w={data:function(){var t=this;return{aparId:"",actiIdToEdit:"",addActivityModal:!1,updateActivityModal:!1,detailActivityModel:!1,editBaseFormModel:!1,updateId:null,detailVO:{},selections:[],removeModal:!1,setting:{loading:!0,showBorder:!0},search:{type:"title",value:""},columns:[{title:"详情",width:60,render:function(e,a){return e("Icon",{props:{type:"ios-list-box-outline",size:"24",color:"#8f90a2"},on:{click:function(){t.openDetailModal(a.row)}}},"")}},{title:"活动名称",key:"title",sortable:!0},{title:"状态",key:"status",width:80,render:function(t,e){var a;switch(e.row.status){case m:a="已发布";break;case g:a="进行中";break;case f:a="已完成";break;case v:a="已取消";break;case y:a="已结束";break;case h:a="草稿";break;default:a="error"}return t("span",a)},sortable:!0},{title:"已参与名额",key:"limitQuota",render:function(t,e){return t("span",e.row.memberNow+" / "+e.row.limitQuota)}},{title:"报名时间",key:"signupTime",width:160,render:function(t,e){return t("span",r()(e.row.signupTime).format("YYYY-MM-DD HH:mm:ss")+" / "+r()(e.row.deadlineTime).format("YYYY-MM-DD HH:mm:ss"))},sortable:!0},{title:"活动时间",key:"activityTime",width:160,render:function(t,e){return t("span",r()(e.row.startTime).format("YYYY-MM-DD HH:mm:ss")+" / "+r()(e.row.endTime).format("YYYY-MM-DD HH:mm:ss"))},sortable:!0},{title:"创建日期",key:"createTime",render:function(t,e){return t("span",r()(e.row.createTime).format("YYYY-MM-DD HH:mm:ss"))},sortable:!0},{title:"操作",key:"action",width:200,align:"center",render:function(e,a){switch(a.row.status){case m:return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.openEditModal(a.row)}}},"编辑"),e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeStatus(a.row,v)}}},"取消")]);case g:return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.openEditModal(a.row)}}},"编辑"),e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeStatus(a.row,v)}}},"取消")]);case h:return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeStatus(a.row,m)}}},"发布"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.openEditModal(a.row)}}},"编辑"),e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeStatus(a.row,v)}}},"取消")]);case f:return e("div",[e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.linkToScore(a.row.id)}}},"评奖"),e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeStatus(a.row,v)}}},"取消")])}}}],data:{},dataFilter:{page:1,pageSize:15},removeObject:null,roles:null,editBaseForm:!1}},components:{AddActivity:l["a"],UpdateActivity:d["a"],DetailActivity:u["a"],BaseForm:p["a"]},created:function(){this.aparId=this.$store.state.user.aparId,this.getData()},methods:{pageChange:function(t){this.dataFilter.page=t,this.getData()},pageSizeChange:function(t){this.dataFilter.pageSize=t,this.getData()},changeStatus:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e,a){var i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,i=a==v?"已取消":"已发布",n={aid:e.id,status:a},t.prev=3,t.next=6,Object(c["b"])("/app/activity/statusChange",n);case 6:t.sent,this.$Message.destroy(),this.$Message.success(i),a==v||(e.status=m),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),this.$throw(t.t0);case 15:this.setting.loading=!1,this.getData();case 17:case"end":return t.stop()}},t,this,[[3,12]])}));function e(e,a){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,t.prev=1,t.next=4,Object(c["b"])("/app/activity/list/aparId",{id:this.aparId,page:this.dataFilter.page,pageSize:this.dataFilter.pageSize});case 4:e=t.sent,this.data=e.data,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),this.$throw(t.t0);case 11:this.setting.loading=!1;case 12:case"end":return t.stop()}},t,this,[[1,8]])}));function e(){return t.apply(this,arguments)}return e}(),openAddModal:function(t){null==t?this.addActivityModal=!0:(this.updateId=t,this.updateActivityModal=!0)},openDetailModal:function(t){this.detailVO=t,this.detailActivityModel=!0},openEditModal:function(t){this.actiIdToEdit=t.id,this.editBaseFormModel=!0},onModalCancel:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:flase;switch(t){case"add":this.addActivityModal=!1,this.getData();break;case"update":this.updateActivityModal=!1,this.getData();break;case"detail":this.detailActivityModel=!1;break}},reEditBaseForm:function(t){this.editBaseForm=t},refreshBaseForm:function(){this.$refs.baseForm.getData()},linkToScore:function(t){this.$router.push({path:"score/".concat(t)})},exportData:function(t){var e=this;1===t&&this.$refs.table.exportCsv({filename:"活动数据-"+(new Date).getTime(),columns:this.columns.filter(function(t,a){return a>1&&a<e.columns.length-1}),data:this.data})}}},b=w,M=a("2877"),k=Object(M["a"])(b,i,n,!1,null,null,null);k.options.__file="manage.vue";e["default"]=k.exports}}]);
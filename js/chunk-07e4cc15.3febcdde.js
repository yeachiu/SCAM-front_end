(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07e4cc15"],{"5a0c":function(t,e,n){!function(e,n){t.exports=n()}(0,function(){"use strict";var t="millisecond",e="second",n="minute",i="hour",a="day",r="week",s="month",o="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})(.*?(\d{1,2}):(\d{1,2}):(\d{1,2}))?.?(\d{1,3})?$/,u=/\[.*?\]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},h=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},d={padStart:h,padZoneStr:function(t){var e=Math.abs(t),n=Math.floor(e/60),i=e%60;return(t<=0?"+":"-")+h(n,2,"0")+":"+h(i,2,"0")},monthDiff:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(n,"months"),a=e-i<0,r=t.clone().add(n+(a?-1:1),"months");return Number(-(n+(e-i)/(a?i-r:r-i))||0)},absFloor:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},prettyUnit:function(c){return{M:s,y:o,w:r,d:a,h:i,m:n,s:e,ms:t}[c]||String(c||"").toLowerCase().replace(/s$/,"")},isUndefined:function(t){return void 0===t}},f="en",p={};p[f]=l;var g=function(t){return t instanceof w},m=function(t,e,n){var i;if(!t)return null;if("string"==typeof t)p[t]&&(i=t),e&&(p[t]=e,i=t);else{var a=t.name;p[a]=t,i=a}return n||(f=i),i},$=function(t,e){if(g(t))return t.clone();var n=e?"string"==typeof e?{format:e}:e:{};return n.date=t,new w(n)},v=function(t,e){return $(t,{locale:e.$L})},y=d;y.parseLocale=m,y.isDayjs=g,y.wrapper=v;var w=function(){function l(t){this.parse(t)}var h=l.prototype;return h.parse=function(t){var e,n;this.$d=null===(e=t.date)?new Date(NaN):y.isUndefined(e)?new Date:e instanceof Date?e:"string"==typeof e&&/.*[^Z]$/i.test(e)&&(n=e.match(c))?new Date(n[1],n[2]-1,n[3]||1,n[5]||0,n[6]||0,n[7]||0,n[8]||0):new Date(e),this.init(t)},h.init=function(t){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds(),this.$L=this.$L||m(t.locale,null,!0)||f},h.$utils=function(){return y},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(t,e){var n=$(t);return this.startOf(e)<=n&&n<=this.endOf(e)},h.isAfter=function(t,e){return $(t)<this.startOf(e)},h.isBefore=function(t,e){return this.endOf(e)<$(t)},h.year=function(){return this.$y},h.month=function(){return this.$M},h.day=function(){return this.$W},h.date=function(){return this.$D},h.hour=function(){return this.$H},h.minute=function(){return this.$m},h.second=function(){return this.$s},h.millisecond=function(){return this.$ms},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,c){var u=this,l=!!y.isUndefined(c)||c,h=function(t,e){var n=v(new Date(u.$y,e,t),u);return l?n:n.endOf(a)},d=function(t,e){return v(u.toDate()[t].apply(u.toDate(),(l?[0,0,0,0]:[23,59,59,999]).slice(e)),u)};switch(y.prettyUnit(t)){case o:return l?h(1,0):h(31,11);case s:return l?h(1,this.$M):h(0,this.$M+1);case r:return h(l?this.$D-this.$W:this.$D+(6-this.$W),this.$M);case a:case"date":return d("setHours",0);case i:return d("setMinutes",1);case n:return d("setSeconds",2);case e:return d("setMilliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(r,c){var u,l=y.prettyUnit(r),h=(u={},u[a]="setDate",u.date="setDate",u[s]="setMonth",u[o]="setFullYear",u[i]="setHours",u[n]="setMinutes",u[e]="setSeconds",u[t]="setMilliseconds",u)[l],d=l===a?this.$D+(c-this.$W):c;return this.$d[h]&&this.$d[h](d),this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.add=function(t,c){var u,l=this;t=Number(t);var h=y.prettyUnit(c),d=function(e,n){var i=l.set("date",1).set(e,n+t);return i.set("date",Math.min(l.$D,i.daysInMonth()))},f=function(e){var n=new Date(l.$d);return n.setDate(n.getDate()+e*t),v(n,l)};if(h===s)return d(s,this.$M);if(h===o)return d(o,this.$y);if(h===a)return f(1);if(h===r)return f(7);var p=(u={},u[n]=6e4,u[i]=36e5,u[e]=1e3,u)[h]||1,g=this.valueOf()+t*p;return v(g,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=y.padZoneStr(this.$d.getTimezoneOffset()),a=this.$locale(),r=a.weekdays,s=a.months,o=function(t,e,n,i){return t&&t[e]||n[e].substr(0,i)},c=function(t){return 0===e.$H?12:y.padStart(e.$H<13?e.$H:e.$H-12,"hh"===t?2:1,"0")};return n.replace(u,function(t){return t.indexOf("[")>-1?t.replace(/\[|\]/g,""):{YY:String(e.$y).slice(-2),YYYY:String(e.$y),M:String(e.$M+1),MM:y.padStart(e.$M+1,2,"0"),MMM:o(a.monthsShort,e.$M,s,3),MMMM:s[e.$M],D:String(e.$D),DD:y.padStart(e.$D,2,"0"),d:String(e.$W),dd:o(a.weekdaysMin,e.$W,r,2),ddd:o(a.weekdaysShort,e.$W,r,3),dddd:r[e.$W],H:String(e.$H),HH:y.padStart(e.$H,2,"0"),h:c(t),hh:c(t),a:e.$H<12?"am":"pm",A:e.$H<12?"AM":"PM",m:String(e.$m),mm:y.padStart(e.$m,2,"0"),s:String(e.$s),ss:y.padStart(e.$s,2,"0"),SSS:y.padStart(e.$ms,3,"0"),Z:i}[t]||i.replace(":","")})},h.diff=function(t,c,u){var l,h=y.prettyUnit(c),d=$(t),f=this-d,p=y.monthDiff(this,d);return p=(l={},l[o]=p/12,l[s]=p,l.quarter=p/3,l[r]=f/6048e5,l[a]=f/864e5,l[i]=f/36e5,l[n]=f/6e4,l[e]=f/1e3,l)[h]||f,u?p:y.absFloor(p)},h.daysInMonth=function(){return this.endOf(s).$D},h.$locale=function(){return p[this.$L]},h.locale=function(t,e){var n=this.clone();return n.$L=m(t,e,!0),n},h.clone=function(){return v(this.toDate(),this)},h.toDate=function(){return new Date(this.$d)},h.toArray=function(){return[this.$y,this.$M,this.$D,this.$H,this.$m,this.$s,this.$ms]},h.toJSON=function(){return this.toISOString()},h.toISOString=function(){return this.$d.toISOString()},h.toObject=function(){return{years:this.$y,months:this.$M,date:this.$D,hours:this.$H,minutes:this.$m,seconds:this.$s,milliseconds:this.$ms}},h.toString=function(){return this.$d.toUTCString()},l}();return $.prototype=w.prototype,$.extend=function(t,e){return t(e,w,$),$},$.locale=m,$.isDayjs=g,$.unix=function(t){return $(1e3*t)},$.en=p[f],$})},9370:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Row",[n("Col",{attrs:{span:"14"}},[n("Button",{attrs:{type:"info"},on:{click:t.doAllocate}},[n("Icon",{attrs:{type:"md-add"}}),t._v(" 提交分配")],1),n("Button",{attrs:{disabled:t.setting.loading,type:"success"},on:{click:t.refresh}},[n("Icon",{attrs:{type:"md-refresh"}}),t._v(" 刷新数据")],1)],1),n("Col",{attrs:{span:"10"}},[n("Select",{attrs:{filterable:""},model:{value:t.targetId,callback:function(e){t.targetId=e},expression:"targetId"}},t._l(t.activities,function(e){return n("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.title))])}),1)],1)],1),n("Row",{staticStyle:{"margin-top":"20px"}},[n("Col",{attrs:{span:"24"}},[n("Table",{ref:"table",staticClass:"margin-bottom-10",attrs:{columns:t.ScoreColumns,loading:t.setting.loading,border:t.setting.showBorder,data:t.targetData}})],1)],1),n("Modal",{attrs:{title:"分配学分","mask-closable":!1,closable:!1,width:"600"},model:{value:t.showAllocateModal,callback:function(e){t.showAllocateModal=e},expression:"showAllocateModal"}},[n("Col",{staticStyle:{"font-size":"16px",color:"#6b6868",padding:"5px 0"},attrs:{span:"24"}},[n("span",{staticStyle:{margin:"0 20px"}},[n("Icon",{attrs:{type:"md-flame",size:"20",color:"#ea6f5a"}}),t._v(" "+t._s(t.targetActi.title)+t._s(t.targetScore.awardName))],1)]),n("Table",{ref:"table",staticClass:"margin-bottom-10",attrs:{columns:t.columns,loading:t.setting.loading,border:t.setting.showBorder,data:t.checkedList}}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"default",disabled:t.setting.loading},on:{click:t.cancel}},[t._v("取消")]),n("Button",{attrs:{type:"primary",loading:t.setting.loading},on:{click:t.ok}},[t._v("确定")])],1)],1)],1)},a=[],r=(n("96cf"),n("3b8d")),s=(n("7f7f"),n("ac6a"),n("5a0c"),n("d689")),o=4,c={data:function(){var t=this;return{aparId:"",setting:{loading:!0,showBorder:!0},search:{type:"name",value:""},dataFilter:{page:1,pageSize:15},showAllocateModal:!1,activities:[],targetId:"",targetData:[],checkedList:[],targetActi:{},targetScore:{},columns:[],ScoreColumns:[{title:"奖项名",key:"awardName"},{title:"学分",key:"awardScore"},{title:"名额",key:"awardNum"},{title:"名单",width:300,render:function(t,e){var n=[];return null!=e.row.allocateList&&e.row.allocateList.length>0?(e.row.allocateList.forEach(function(e){var i=t("Tag",{props:{color:"blue"}},e.name);n.push(i)}),t("div",join)):t("span","空")}},{title:"添加",width:80,render:function(e,n){return e("Button",{props:{type:"success",size:"small"},style:{margin:"5px"},on:{click:function(){t.openAllocateModal(n.row)}}},"添加")}}]}},components:{},created:function(){this.aparId=this.$store.state.user.aparId,this.targetId=this.$route.params.id,this.getData()},methods:{pageChange:function(t){this.dataFilter.page=t,this.getData()},pageSizeChange:function(t){this.dataFilter.pageSize=t,this.getData()},refresh:function(){this.getData(),this.getFormRules(),this.getSignupData()},doSearch:function(){alert("not ready, please wait")},getData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,t.prev=1,t.next=4,Object(s["b"])("/app/activity/list/status",{aparId:this.aparId,status:o});case 4:e=t.sent,this.activities=e.data,null!=this.activities&&""!=this.targetId&&(""==this.targetId?(this.targetId=this.activities[0].id,this.targetActi=this.activities[0]):this.activities.forEach(function(t){t.id!=n.targetId||(n.targetActi=t)})),this.getScoreSettingData(),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),this.$throw(t.t0);case 13:this.setting.loading=!1;case 14:case"end":return t.stop()}},t,this,[[1,10]])}));function e(){return t.apply(this,arguments)}return e}(),getScoreSettingData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.checkedNum=0,this.setting.loading=!0,t.prev=2,t.next=5,Object(s["b"])("/app/score/get/actiId/{actiId}",null,{actiId:this.targetId});case 5:e=t.sent,n=e.data,this.targetData=n.map(function(t){return{id:t.id,actiId:t.aid,awardName:t.awardName,awardNum:t.awardNum,awardScore:t.awardScore,allocateList:[]}}),console.info(this.targetData),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),this.$throw(t.t0);case 14:this.setting.loading=!1;case 15:case"end":return t.stop()}},t,this,[[2,11]])}));function e(){return t.apply(this,arguments)}return e}(),openAllocateModal:function(){this.getSignupData(),this.showAllocateModal=!0},doAllocate:function(){alert("功能待完善……")},getSignupData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.checkedNum=0,this.setting.loading=!0,t.prev=2,t.next=5,Object(s["b"])("/app/activity/signup/get/list/{actiId}",null,{actiId:this.targetId});case 5:e=t.sent,n=e.data,this.checkedList=[],n.forEach(function(t){t=JSON.parse(t),t.checkin&&i.checkedList.push(t)}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),this.$throw(t.t0);case 14:this.setting.loading=!1;case 15:case"end":return t.stop()}},t,this,[[2,11]])}));function e(){return t.apply(this,arguments)}return e}(),getFormRules:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setting.loading=!0,t.prev=1,t.next=4,Object(s["b"])("/app/activity/form/get/{id}",null,{id:this.targetId});case 4:e=t.sent,this.targetRules=JSON.parse(e.data.rules),this.columns=[],n={type:"selection",width:60,align:"center"},this.columns.push(n),this.targetRules.forEach(function(t){if("hidden"!=t.type){var e={title:t.title,key:t.field,sortable:!0};i.columns.push(e)}}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$throw(t.t0);case 15:this.setting.loading=!1;case 16:case"end":return t.stop()}},t,this,[[1,12]])}));function e(){return t.apply(this,arguments)}return e}(),cancel:function(){this.showAllocateModal=!1},ok:function(){this.cancel()},exportData:function(t){var e=this;1===t&&this.$refs.table.exportCsv({filename:"报名数据-"+(new Date).getTime(),columns:this.columns.filter(function(t,n){return n>1&&n<e.columns.length-1}),data:this.data})}},watch:{targetId:function(t,e){this.getFormRules(),this.getSignupData()}}},u=c,l=n("2877"),h=Object(l["a"])(u,i,a,!1,null,null,null);h.options.__file="index.vue";e["default"]=h.exports}}]);
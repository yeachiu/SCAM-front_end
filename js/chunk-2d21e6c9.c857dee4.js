(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21e6c9"],{d601:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("p",{staticClass:"card-title",attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"home"}}),a("span",[e._v("分组管理")])],1),a("div",[[a("Row",[a("Col",{attrs:{span:"15"}},[a("Button",{attrs:{type:"info"},on:{click:function(t){e.openAddOrUpModal(null)}}},[a("Icon",{attrs:{type:"md-add"}}),e._v(" 添加分组")],1),a("Button",{attrs:{disabled:e.setting.loading,type:"success"},on:{click:e.getData}},[a("Icon",{attrs:{type:"md-refresh"}}),e._v(" 刷新数据")],1),a("Button",{attrs:{type:"primary"},on:{click:function(t){e.exportData(1)}}},[a("Icon",{attrs:{type:"ios-download-outline"}}),e._v(" 导出表格")],1)],1),a("Col",{attrs:{span:"9"}},[a("Input",{staticClass:"margin-bottom-10",attrs:{placeholder:"请输入您想要搜索的内容..."},model:{value:e.search.value,callback:function(t){e.$set(e.search,"value",t)},expression:"search.value"}},[a("Button",{attrs:{slot:"append",icon:"ios-search"},slot:"append"})],1)],1)],1),a("Table",{ref:"table",staticClass:"margin-bottom-10",attrs:{columns:e.columns,loading:e.setting.loading,border:e.setting.showBorder,data:e.data}})]],2)]),e.addGroupModal?a("AddGroup",{attrs:{allMember:e.allMember,"add-Id":e.aparId},on:{cancel:e.onAddGroupModalCancel}}):e._e(),e.updateGroupModal?a("UpdateGroup",{attrs:{allMember:e.allMember,"update-object":e.updateObject},on:{cancel:e.onUpdateGroupModalCancel}}):e._e(),a("Modal",{attrs:{width:"360"},model:{value:e.removeModal,callback:function(t){e.removeModal=t},expression:"removeModal"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),a("span",[e._v("提示")])],1),a("div",{staticStyle:{"text-align":"center"}},[a("p",[e._v("此操作为不可逆操作，是否确认删除？")])]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:"",loading:e.setting.loading},on:{click:e.remove}},[e._v("确认删除")])],1)])],1)},n=[],o=a("7618"),i=(a("7f7f"),a("ac6a"),a("96cf"),a("3b8d")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{attrs:{title:"小组添加",loading:e.loading,"mask-closable":!1,width:800,closable:!1},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("Form",{ref:"addGroup",attrs:{model:e.formItem,"label-width":90,rules:e.ruleValidate}},[a("FormItem",{attrs:{label:"小组名称：",prop:"name"}},[a("Input",{attrs:{placeholder:"小组名称"},model:{value:e.formItem.name,callback:function(t){e.$set(e.formItem,"name",t)},expression:"formItem.name"}})],1)],1),a("Form",{attrs:{"label-width":70}},[a("FormItem",{attrs:{label:"组成员：",prop:"members"}},[a("CheckboxGroup",{on:{"on-change":e.getCheckedNodes},model:{value:e.formItem.members,callback:function(t){e.$set(e.formItem,"members",t)},expression:"formItem.members"}},e._l(e.allMember,function(t,r){return a("Checkbox",{key:r,attrs:{label:t.uid}},[a("span",[e._v(e._s(t.realName))])])}),1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default",disabled:e.loading},on:{click:function(t){e.cancel(!1)}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.ok}},[e._v("确定")])],1)],1)],1)},l=[],c=a("d689"),d={data:function(){return{formItem:{name:"",members:[],apartmentId:this.addId},checkedNodes:[],showModal:!0,loading:!1,ruleValidate:{name:[{required:!0,message:"小组名称不能为空"}]}}},props:{allMember:{type:Array},addId:String},created:function(){var e=this;null!=this.updateObject&&(this.formItem.name=this.updateObject.name,this.updateObject.members.forEach(function(t){e.formItem.members.push(t.uid)}))},methods:{cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e)},getCheckedNodes:function(e){var t=this;e.forEach(function(e){t.allMember.forEach(function(a){a.uid==e&&t.checkedNodes.push(a)})})},ok:function(){var e=this,t=this.checkedNodes;this.$refs.addGroup.validate(function(a){if(a)if(t.length<1)e.$Notice.destroy(),e.$Notice.warning({title:"请至少选择一个成员",duration:2});else{var r={name:e.formItem.name,members:t};e.add(r)}})},add:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,Object(c["b"])("/apartment/group/add",t);case 4:e.sent,this.$Message.success("小组 "+t.name+" 创建成功"),this.cancel(!0),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$throw(e.t0);case 12:this.loading=!1;case 13:case"end":return e.stop()}},e,this,[[1,9]])}));function t(t){return e.apply(this,arguments)}return t}()}},u=d,m=a("2877"),p=Object(m["a"])(u,s,l,!1,null,null,null);p.options.__file="addGroup.vue";var h=p.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{attrs:{title:"更新小组",loading:e.loading,"mask-closable":!1,width:800,closable:!1},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("Form",{ref:"updateGroup",attrs:{model:e.formItem,"label-width":90,rules:e.ruleValidate}},[a("FormItem",{attrs:{label:"小组名称：",prop:"name"}},[a("Input",{attrs:{placeholder:"小组名称"},model:{value:e.formItem.name,callback:function(t){e.$set(e.formItem,"name",t)},expression:"formItem.name"}})],1)],1),a("Form",{attrs:{"label-width":70}},[a("FormItem",{attrs:{label:"组成员：",prop:"members"}},[a("CheckboxGroup",{on:{"on-change":e.getCheckedNodes},model:{value:e.formItem.members,callback:function(t){e.$set(e.formItem,"members",t)},expression:"formItem.members"}},e._l(e.allMember,function(t,r){return a("Checkbox",{key:r,attrs:{label:t.uid}},[a("span",[e._v(e._s(t.realName))])])}),1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default",disabled:e.loading},on:{click:function(t){e.cancel(!1)}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.ok}},[e._v("确定")])],1)],1)],1)},b=[],g={data:function(){return{formItem:{name:"",members:[]},checkedNodes:[],showModal:!0,loading:!1,ruleValidate:{name:[{required:!0,message:"小组名称不能为空"}]}}},props:{updateObject:{type:Object,default:null},allMember:{type:Array}},created:function(){var e=this;null!=this.updateObject&&(this.formItem.name=this.updateObject.name,this.updateObject.members.forEach(function(t){e.formItem.members.push(t.uid)}))},methods:{cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e)},getCheckedNodes:function(e){var t=this;e.forEach(function(e){t.allMember.forEach(function(a){a.uid==e&&t.checkedNodes.push(a)})})},ok:function(){var e=this,t=this.checkedNodes;this.$refs.updateGroup.validate(function(a){if(a)if(t.length<1)e.$Notice.destroy(),e.$Notice.warning({title:"请至少选择一个成员",duration:2});else{var r={name:e.formItem.name,members:t};e.update(r)}})},update:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,Object(c["b"])("/apartment/group/update/{id}",t,{id:this.updateObject.id});case 4:e.sent,this.$Message.success("小组 "+t.name+" 更新成功"),this.cancel(!0),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$throw(e.t0);case 12:this.loading=!1;case 13:case"end":return e.stop()}},e,this,[[1,9]])}));function t(t){return e.apply(this,arguments)}return t}()}},v=g,k=Object(m["a"])(v,f,b,!1,null,null,null);k.options.__file="updateGroup.vue";var w=k.exports,M={data:function(){var e=this;return{aparId:"",addGroupModal:!1,updateGroupModal:!1,updateObject:null,removeModal:!1,setting:{loading:!0,showBorder:!0},search:{type:"name",value:""},columns:[{title:"ID",key:"id",sortable:!0},{title:"小组名",key:"name",sortable:!0},{title:"操作",key:"action",width:260,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showAllMember(a.row)}}},"查看组成员"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.openAddOrUpModal(a.row)}}},"修改信息"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.removeObject={obj:a.row,index:a.index},e.removeModal=!0}}},"删除")])}}],data:[{id:"01001",name:"1号小组",members:[{uid:"111111",realName:"科别拉"},{uid:"111365",realName:"系统管理员"}]}],dataFilter:{page:1,pageSize:10},removeObject:null,allMember:null}},components:{AddGroup:h,UpdateGroup:w},created:function(){this.aparId=this.$store.state.user.aparId,this.getData()},methods:{pageChange:function(e){this.dataFilter.page=e,this.getData()},pageSizeChange:function(e){this.dataFilter.pageSize=e,this.getData()},getAllMember:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.allMember=[{uid:"111111",realName:"科别拉"},{uid:"111365",realName:"系统管理员"}];case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),remove:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.removeModal=!1,null!=this.removeObject){e.next=4;break}return this.$Message.warning("删除对象为空，无法继续执行！"),e.abrupt("return",!1);case 4:return this.setting.loading=!0,e.prev=5,e.next=8,Object(c["b"])("/app/apartment/member/remove/{uid}",null,{uid:this.removeObject.obj.id});case 8:e.sent,this.$Message.success("删除成功"),this.data.splice(this.removeObject.index,1),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](5),this.$throw(e.t0);case 16:this.setting.loading=!1;case 17:case"end":return e.stop()}},e,this,[[5,13]])}));function t(){return e.apply(this,arguments)}return t}(),getData:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.setting.loading=!0,e.prev=1,e.next=4,Object(c["b"])("/app/apartment/group/list/{id}",null,{id:this.aparId});case 4:t=e.sent,this.data=t.data,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),this.$throw(e.t0);case 11:this.setting.loading=!1;case 12:case"end":return e.stop()}},e,this,[[1,8]])}));function t(){return e.apply(this,arguments)}return t}(),openAddOrUpModal:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var a,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=r.length>1&&void 0!==r[1]?r[1]:"update",null!==this.allMember){e.next=4;break}return e.next=4,this.getAllMember();case 4:null===t?this.addGroupModal=!0:"update"===a&&(this.updateObject=t,this.updateGroupModal=!0);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),onAddGroupModalCancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.addGroupModal=!1,e&&this.getData()},onUpdateGroupModalCancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateGroupModal=!1,e&&this.getData()},dealPostData:function(e,t,a){var r=this;null!=e&&e.forEach(function(e){var n=a("Tag",{props:{color:"green",type:"dot"}},e.name);t.push(n),null!=e.children&&r.dealPostData(e.children,t,a)})},showAllMember:function(e){var t=this,a=e.members;null!=a&&"object"==Object(o["a"])(a)&&a.length>0?this.$Modal.info({title:e.name+" - 组成员",width:"40%",render:function(e){var r=[];return a.forEach(function(a){var n=e("Tag",{props:{color:""==a.color?"green":a.color,type:"dot"}},a.realName);r.push(n),t.dealPostData(a.children,r,e)}),e("div",{style:{padding:"20px 0 10px 0"}},r)}}):(this.$Notice.destroy(),this.$Notice.info({title:"该分组暂无成员",duration:3}))},exportData:function(e){var t=this;1===e&&this.$refs.table.exportCsv({filename:"组成员数据-"+(new Date).getTime(),columns:this.columns.filter(function(e,a){return a>1&&a<t.columns.length-1}),data:this.data})}}},y=M,x=Object(m["a"])(y,r,n,!1,null,null,null);x.options.__file="group.vue";t["default"]=x.exports}}]);